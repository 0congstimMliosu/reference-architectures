{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#","contentVersion":"1.0.0.0","parameters":{"virtualMachines":{"value":[{"publicIpAddresses":[{"name":"ra-multi-lb-ra-multi-vm-lb-fe-config1-pip","id":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Network/publicIPAddresses/ra-multi-lb-ra-multi-vm-lb-fe-config1-pip","resourceGroupName":"ra-multi-vm-windows-rg","subscriptionId":"628dad04-b5d1-4f10-b3a4-dc61d88cf97c","location":"westus","properties":{"publicIPAllocationMethod":"Static","publicIPAddressVersion":"IPv4"}}],"networkInterfaces":[],"availabilitySet":[],"scaleSet":[{"name":"ra-multi-ss","sku":{"name":"Standard_DS2_v2","tier":"Standard","capacity":3},"properties":{"upgradePolicy":{"mode":"Automatic"},"virtualMachineProfile":{"osProfile":{"adminUsername":"testadminuser","adminPassword":"$SECRET$","windowsConfiguration":{"provisionVmAgent":true},"computerNamePrefix":"web"},"storageProfile":{"osDisk":{"createOption":"fromImage","caching":"ReadWrite","osType":"windows","managedDisk":{"storageAccountType":"Premium_LRS"}},"imageReference":{"publisher":"MicrosoftWindowsServer","offer":"WindowsServer","sku":"2016-Datacenter","version":"latest"},"dataDisks":[]},"networkProfile":{"networkInterfaceConfigurations":[{"name":"ra-multi-vm1-nic1","properties":{"primary":true,"dnsSettings":{"dnsServers":[]},"ipConfigurations":[{"name":"ipconfig1","properties":{"subnet":{"id":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Network/virtualNetworks/ra-multi-vm-vnet/subnets/web"},"privateIPAddressVersion":"IPv4"}}]}}]},"diagnosticsProfile":{"bootDiagnostics":{"enabled":true,"storageUri":"http://vmme5khocmr2lqmdiag1.blob.core.windows.net"}},"extensionProfile":{"extensions":[{"name":"iis-config-ext","properties":{"publisher":"Microsoft.Powershell","type":"DSC","typeHandlerVersion":"2.1","autoUpgradeMinorVersion":true,"settings":{"ModulesUrl":"https://raw.githubusercontent.com/mspnp/reference-architectures/master/scripts/windows/iisaspnet.ps1.zip","configurationFunction":"iisaspnet.ps1\\iisaspnet"},"protectedSettings":{}}}]}},"overprovision":true,"singlePlacementGroup":true},"resourceGroupName":"ra-multi-vm-windows-rg","subscriptionId":"628dad04-b5d1-4f10-b3a4-dc61d88cf97c","location":"westus"}],"autoScaleSettings":[{"name":"ra-multi-ss-auto","properties":{"enabled":true,"profiles":[{"name":"profile-1","capacity":{"minimum":2,"maximum":6,"default":3},"rules":[{"metricTrigger":{"metricName":"Percentage CPU","metricNamespace":"","timeGrain":"PT1M","statistic":"Average","timeWindow":"PT5M","timeAggregation":"Average","operator":"GreaterThan","threshold":"75","metricResourceUri":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Compute/virtualMachineScaleSets/ra-multi-ss"},"scaleAction":{"direction":"Increase","type":"ChangeCount","value":"1","cooldown":"PT1M"}},{"metricTrigger":{"metricName":"Percentage CPU","metricNamespace":"","timeGrain":"PT1M","statistic":"Average","timeWindow":"PT5M","timeAggregation":"Average","operator":"LessThan","threshold":"25","metricResourceUri":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Compute/virtualMachineScaleSets/ra-multi-ss"},"scaleAction":{"direction":"Decrease","type":"ChangeCount","value":"1","cooldown":"PT1M"}}]}],"name":"ra-multi-ss-auto","targetResourceUri":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Compute/virtualMachineScaleSets/ra-multi-ss"},"resourceGroupName":"ra-multi-vm-windows-rg","subscriptionId":"628dad04-b5d1-4f10-b3a4-dc61d88cf97c","location":"westus"}],"loadBalancer":[{"name":"ra-multi-lb","resourceGroupName":"ra-multi-vm-windows-rg","subscriptionId":"628dad04-b5d1-4f10-b3a4-dc61d88cf97c","location":"westus","properties":{"frontendIPConfigurations":[{"name":"ra-multi-vm-lb-fe-config1","properties":{"privateIPAllocationMethod":"Dynamic","publicIPAddress":{"id":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Network/publicIPAddresses/ra-multi-lb-ra-multi-vm-lb-fe-config1-pip"}}}],"loadBalancingRules":[{"name":"lbr1","properties":{"frontendIPConfiguration":{"id":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Network/loadBalancers/ra-multi-lb/frontendIPConfigurations/ra-multi-vm-lb-fe-config1"},"backendAddressPool":{"id":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Network/loadBalancers/ra-multi-lb/backendAddressPools/ra-multi-vm-lb-bep1"},"frontendPort":80,"backendPort":80,"protocol":"Tcp","enableFloatingIP":false,"loadDistribution":"Default","probe":{"id":"/subscriptions/628dad04-b5d1-4f10-b3a4-dc61d88cf97c/resourceGroups/ra-multi-vm-windows-rg/providers/Microsoft.Network/loadBalancers/ra-multi-lb/probes/lbp1"}}}],"probes":[{"name":"lbp1","properties":{"port":80,"protocol":"Http","requestPath":"/","intervalInSeconds":15,"numberOfProbes":2}}],"backendAddressPools":[{"name":"ra-multi-vm-lb-bep1"}],"inboundNatRules":[],"inboundNatPools":[]}}],"applicationGateways":[],"storageAccounts":[],"diagnosticStorageAccounts":[{"resourceGroupName":"ra-multi-vm-windows-rg","subscriptionId":"628dad04-b5d1-4f10-b3a4-dc61d88cf97c","location":"westus","name":"vmme5khocmr2lqmdiag1","kind":"Storage","sku":{"name":"Standard_LRS"},"properties":{}}],"virtualMachines":[]}]},"secrets":{"value":{"secrets":[{"value":"test$!Passw0rd111"}]}},"deploymentContext":{"value":{"parentTemplateUniqueString":"bb-03-vm","sasToken":""}}}}